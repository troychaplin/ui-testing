import{r as a,R as T}from"./index-CBqU2yxZ.js";import{O as Q,U as j,y as K,T as me,n as re,f as oe,s as ie,o as E,e as Pe,N as be,E as Se,a as ye,b as Ee,u as A,d as U,C as z,I as q,c as ce,g as ee,h as te,i as pe,j as ge,l as $e,k as L,M as N,m as Ie,p as he,q as Te,r as G,t as de,v as xe,w as _,x as ne}from"./transition-Detct5jf.js";import{T as Me}from"./use-resolve-button-type-BBdwncF-.js";var we=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(we||{}),Ce=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(Ce||{});let Oe={0:e=>{let o={...e,popoverState:A(e.popoverState,{0:1,1:0})};return o.popoverState===0&&(o.__demoMode=!1),o},1(e){return e.popoverState===1?e:{...e,popoverState:1}},2(e,o){return e.button===o.button?e:{...e,button:o.button}},3(e,o){return e.buttonId===o.buttonId?e:{...e,buttonId:o.buttonId}},4(e,o){return e.panel===o.panel?e:{...e,panel:o.panel}},5(e,o){return e.panelId===o.panelId?e:{...e,panelId:o.panelId}}},le=a.createContext(null);le.displayName="PopoverContext";function X(e){let o=a.useContext(le);if(o===null){let v=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(v,X),v}return o}let ae=a.createContext(null);ae.displayName="PopoverAPIContext";function ue(e){let o=a.useContext(ae);if(o===null){let v=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(v,ue),v}return o}let se=a.createContext(null);se.displayName="PopoverGroupContext";function fe(){return a.useContext(se)}let Z=a.createContext(null);Z.displayName="PopoverPanelContext";function ke(){return a.useContext(Z)}function Fe(e,o){return A(o.type,Oe,e,o)}let Be="div";function Re(e,o){var v;let{__demoMode:g=!1,...x}=e,l=a.useRef(null),t=K(o,me(u=>{l.current=u})),m=a.useRef([]),P=a.useReducer(Fe,{__demoMode:g,popoverState:g?0:1,buttons:m,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:a.createRef(),afterPanelSentinel:a.createRef()}),[{popoverState:b,button:i,buttonId:$,panel:r,panelId:R,beforePanelSentinel:w,afterPanelSentinel:S},s]=P,d=re((v=l.current)!=null?v:i),M=a.useMemo(()=>{if(!i||!r)return!1;for(let J of document.querySelectorAll("body > *"))if(Number(J==null?void 0:J.contains(i))^Number(J==null?void 0:J.contains(r)))return!0;let u=oe(),C=u.indexOf(i),V=(C+u.length-1)%u.length,W=(C+1)%u.length,Y=u[V],ve=u[W];return!r.contains(Y)&&!r.contains(ve)},[i,r]),O=ie($),F=ie(R),B=a.useMemo(()=>({buttonId:O,panelId:F,close:()=>s({type:1})}),[O,F,s]),k=fe(),D=k==null?void 0:k.registerPopover,c=E(()=>{var u;return(u=k==null?void 0:k.isFocusWithinPopoverGroup())!=null?u:(d==null?void 0:d.activeElement)&&((i==null?void 0:i.contains(d.activeElement))||(r==null?void 0:r.contains(d.activeElement)))});a.useEffect(()=>D==null?void 0:D(B),[D,B]);let[I,f]=Pe(),n=be({mainTreeNodeRef:k==null?void 0:k.mainTreeNodeRef,portals:I,defaultContainers:[i,r]});Se(d==null?void 0:d.defaultView,"focus",u=>{var C,V,W,Y;u.target!==window&&u.target instanceof HTMLElement&&b===0&&(c()||i&&r&&(n.contains(u.target)||(V=(C=w.current)==null?void 0:C.contains)!=null&&V.call(C,u.target)||(Y=(W=S.current)==null?void 0:W.contains)!=null&&Y.call(W,u.target)||s({type:1})))},!0),ye(n.resolveContainers,(u,C)=>{s({type:1}),he(C,Te.Loose)||(u.preventDefault(),i==null||i.focus())},b===0);let p=E(u=>{s({type:1});let C=u?u instanceof HTMLElement?u:"current"in u&&u.current instanceof HTMLElement?u.current:i:i;C==null||C.focus()}),h=a.useMemo(()=>({close:p,isPortalled:M}),[p,M]),y=a.useMemo(()=>({open:b===0,close:p}),[b,p]),H={ref:t};return T.createElement(Z.Provider,{value:null},T.createElement(le.Provider,{value:P},T.createElement(ae.Provider,{value:h},T.createElement(Ee,{value:A(b,{0:U.Open,1:U.Closed})},T.createElement(f,null,z({ourProps:H,theirProps:x,slot:y,defaultTag:Be,name:"Popover"}),T.createElement(n.MainTreeNode,null))))))}let De="button";function Ne(e,o){let v=q(),{id:g=`headlessui-popover-button-${v}`,...x}=e,[l,t]=X("Popover.Button"),{isPortalled:m}=ue("Popover.Button"),P=a.useRef(null),b=`headlessui-focus-sentinel-${q()}`,i=fe(),$=i==null?void 0:i.closeOthers,r=ke()!==null;a.useEffect(()=>{if(!r)return t({type:3,buttonId:g}),()=>{t({type:3,buttonId:null})}},[r,g,t]);let[R]=a.useState(()=>Symbol()),w=K(P,o,r?null:n=>{if(n)l.buttons.current.push(R);else{let p=l.buttons.current.indexOf(R);p!==-1&&l.buttons.current.splice(p,1)}l.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),n&&t({type:2,button:n})}),S=K(P,o),s=re(P),d=E(n=>{var p,h,y;if(r){if(l.popoverState===1)return;switch(n.key){case G.Space:case G.Enter:n.preventDefault(),(h=(p=n.target).click)==null||h.call(p),t({type:1}),(y=l.button)==null||y.focus();break}}else switch(n.key){case G.Space:case G.Enter:n.preventDefault(),n.stopPropagation(),l.popoverState===1&&($==null||$(l.buttonId)),t({type:0});break;case G.Escape:if(l.popoverState!==0)return $==null?void 0:$(l.buttonId);if(!P.current||s!=null&&s.activeElement&&!P.current.contains(s.activeElement))return;n.preventDefault(),n.stopPropagation(),t({type:1});break}}),M=E(n=>{r||n.key===G.Space&&n.preventDefault()}),O=E(n=>{var p,h;de(n.currentTarget)||e.disabled||(r?(t({type:1}),(p=l.button)==null||p.focus()):(n.preventDefault(),n.stopPropagation(),l.popoverState===1&&($==null||$(l.buttonId)),t({type:0}),(h=l.button)==null||h.focus()))}),F=E(n=>{n.preventDefault(),n.stopPropagation()}),B=l.popoverState===0,k=a.useMemo(()=>({open:B}),[B]),D=Me(e,P),c=r?{ref:S,type:D,onKeyDown:d,onClick:O}:{ref:w,id:l.buttonId,type:D,"aria-expanded":l.popoverState===0,"aria-controls":l.panel?l.panelId:void 0,onKeyDown:d,onKeyUp:M,onClick:O,onMouseDown:F},I=ce(),f=E(()=>{let n=l.panel;if(!n)return;function p(){A(I.current,{[_.Forwards]:()=>L(n,N.First),[_.Backwards]:()=>L(n,N.Last)})===ne.Error&&L(oe().filter(h=>h.dataset.headlessuiFocusGuard!=="true"),A(I.current,{[_.Forwards]:N.Next,[_.Backwards]:N.Previous}),{relativeTo:l.button})}p()});return T.createElement(T.Fragment,null,z({ourProps:c,theirProps:x,slot:k,defaultTag:De,name:"Popover.Button"}),B&&!r&&m&&T.createElement(ee,{id:b,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:f}))}let _e="div",Ge=Q.RenderStrategy|Q.Static;function Le(e,o){let v=q(),{id:g=`headlessui-popover-overlay-${v}`,...x}=e,[{popoverState:l},t]=X("Popover.Overlay"),m=K(o),P=pe(),b=P!==null?(P&U.Open)===U.Open:l===0,i=E(r=>{if(de(r.currentTarget))return r.preventDefault();t({type:1})}),$=a.useMemo(()=>({open:l===0}),[l]);return z({ourProps:{ref:m,id:g,"aria-hidden":!0,onClick:i},theirProps:x,slot:$,defaultTag:_e,features:Ge,visible:b,name:"Popover.Overlay"})}let Ae="div",qe=Q.RenderStrategy|Q.Static;function Ke(e,o){let v=q(),{id:g=`headlessui-popover-panel-${v}`,focus:x=!1,...l}=e,[t,m]=X("Popover.Panel"),{close:P,isPortalled:b}=ue("Popover.Panel"),i=`headlessui-focus-sentinel-before-${q()}`,$=`headlessui-focus-sentinel-after-${q()}`,r=a.useRef(null),R=K(r,o,c=>{m({type:4,panel:c})}),w=re(r),S=ge();$e(()=>(m({type:5,panelId:g}),()=>{m({type:5,panelId:null})}),[g,m]);let s=pe(),d=s!==null?(s&U.Open)===U.Open:t.popoverState===0,M=E(c=>{var I;switch(c.key){case G.Escape:if(t.popoverState!==0||!r.current||w!=null&&w.activeElement&&!r.current.contains(w.activeElement))return;c.preventDefault(),c.stopPropagation(),m({type:1}),(I=t.button)==null||I.focus();break}});a.useEffect(()=>{var c;e.static||t.popoverState===1&&((c=e.unmount)==null||c)&&m({type:4,panel:null})},[t.popoverState,e.unmount,e.static,m]),a.useEffect(()=>{if(t.__demoMode||!x||t.popoverState!==0||!r.current)return;let c=w==null?void 0:w.activeElement;r.current.contains(c)||L(r.current,N.First)},[t.__demoMode,x,r,t.popoverState]);let O=a.useMemo(()=>({open:t.popoverState===0,close:P}),[t,P]),F={ref:R,id:g,onKeyDown:M,onBlur:x&&t.popoverState===0?c=>{var I,f,n,p,h;let y=c.relatedTarget;y&&r.current&&((I=r.current)!=null&&I.contains(y)||(m({type:1}),((n=(f=t.beforePanelSentinel.current)==null?void 0:f.contains)!=null&&n.call(f,y)||(h=(p=t.afterPanelSentinel.current)==null?void 0:p.contains)!=null&&h.call(p,y))&&y.focus({preventScroll:!0})))}:void 0,tabIndex:-1},B=ce(),k=E(()=>{let c=r.current;if(!c)return;function I(){A(B.current,{[_.Forwards]:()=>{var f;L(c,N.First)===ne.Error&&((f=t.afterPanelSentinel.current)==null||f.focus())},[_.Backwards]:()=>{var f;(f=t.button)==null||f.focus({preventScroll:!0})}})}I()}),D=E(()=>{let c=r.current;if(!c)return;function I(){A(B.current,{[_.Forwards]:()=>{var f;if(!t.button)return;let n=oe(),p=n.indexOf(t.button),h=n.slice(0,p+1),y=[...n.slice(p+1),...h];for(let H of y.slice())if(H.dataset.headlessuiFocusGuard==="true"||(f=t.panel)!=null&&f.contains(H)){let u=y.indexOf(H);u!==-1&&y.splice(u,1)}L(y,N.First,{sorted:!1})},[_.Backwards]:()=>{var f;L(c,N.Previous)===ne.Error&&((f=t.button)==null||f.focus())}})}I()});return T.createElement(Z.Provider,{value:g},d&&b&&T.createElement(ee,{id:i,ref:t.beforePanelSentinel,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k}),z({mergeRefs:S,ourProps:F,theirProps:l,slot:O,defaultTag:Ae,features:qe,visible:d,name:"Popover.Panel"}),d&&b&&T.createElement(ee,{id:$,ref:t.afterPanelSentinel,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:D}))}let Ue="div";function He(e,o){let v=a.useRef(null),g=K(v,o),[x,l]=a.useState([]),t=Ie(),m=E(S=>{l(s=>{let d=s.indexOf(S);if(d!==-1){let M=s.slice();return M.splice(d,1),M}return s})}),P=E(S=>(l(s=>[...s,S]),()=>m(S))),b=E(()=>{var S;let s=xe(v);if(!s)return!1;let d=s.activeElement;return(S=v.current)!=null&&S.contains(d)?!0:x.some(M=>{var O,F;return((O=s.getElementById(M.buttonId.current))==null?void 0:O.contains(d))||((F=s.getElementById(M.panelId.current))==null?void 0:F.contains(d))})}),i=E(S=>{for(let s of x)s.buttonId.current!==S&&s.close()}),$=a.useMemo(()=>({registerPopover:P,unregisterPopover:m,isFocusWithinPopoverGroup:b,closeOthers:i,mainTreeNodeRef:t.mainTreeNodeRef}),[P,m,b,i,t.mainTreeNodeRef]),r=a.useMemo(()=>({}),[]),R=e,w={ref:g};return T.createElement(se.Provider,{value:$},z({ourProps:w,theirProps:R,slot:r,defaultTag:Ue,name:"Popover.Group"}),T.createElement(t.MainTreeNode,null))}let We=j(Re),je=j(Ne),ze=j(Le),Ve=j(Ke),Ye=j(He),Ze=Object.assign(We,{Button:je,Overlay:ze,Panel:Ve,Group:Ye});export{Ze as C};
